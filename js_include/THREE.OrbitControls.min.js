THREE.OrbitControls=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,o=new THREE.Vector2,a=new THREE.Vector2,i=new THREE.Vector2,s=new THREE.Vector2,c=new THREE.Vector2,r=new THREE.Vector2,h=new THREE.Vector3,d=new THREE.Vector3,u=new THREE.Vector2,p=new THREE.Vector2,l=new THREE.Vector2,E=0,m=0,f=1,b=new THREE.Vector3,v=new THREE.Vector3,y=new THREE.Quaternion,T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},g=T.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var O=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),R=O.clone().inverse(),H={type:"change"},L={type:"start"},P={type:"end"};function w(){return 2*Math.PI/60/60*n.autoRotateSpeed}function M(){return Math.pow(.95,n.zoomSpeed)}function k(t){if(!1!==n.enabled){t.preventDefault();var e=n.domElement===document?n.domElement.body:n.domElement;if(g===T.ROTATE){if(!0===n.noRotate)return;a.set(t.clientX,t.clientY),i.subVectors(a,o),n.rotateLeft(2*Math.PI*i.x/e.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*i.y/e.clientHeight*n.rotateSpeed),o.copy(a)}else if(g===T.DOLLY){if(!0===n.noZoom)return;p.set(t.clientX,t.clientY),l.subVectors(p,u),l.y>0?n.dollyIn():n.dollyOut(),u.copy(p)}else if(g===T.PAN){if(!0===n.noPan)return;c.set(t.clientX,t.clientY),r.subVectors(c,s),n.pan(r.x,r.y),s.copy(c)}n.update()}}function N(){!1!==n.enabled&&(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",N,!1),n.dispatchEvent(P),g=T.NONE)}function V(t){if(!1!==n.enabled&&!0!==n.noZoom){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?n.dollyOut():n.dollyIn(),n.update(),n.dispatchEvent(L),n.dispatchEvent(P)}}this.rotateLeft=function(t){void 0===t&&(t=w()),m-=t},this.rotateUp=function(t){void 0===t&&(t=w()),E-=t},this.panLeft=function(t){var e=this.object.matrix.elements;h.set(e[0],e[1],e[2]),h.multiplyScalar(-t),b.add(h)},this.panUp=function(t){var e=this.object.matrix.elements;h.set(e[4],e[5],e[6]),h.multiplyScalar(t),b.add(h)},this.pan=function(t,e){var o=n.domElement===document?n.domElement.body:n.domElement;if(void 0!==n.object.fov){var a=n.object.position.clone().sub(n.target).length();a*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*t*a/o.clientHeight),n.panUp(2*e*a/o.clientHeight)}else void 0!==n.object.top?(n.panLeft(t*(n.object.right-n.object.left)/o.clientWidth),n.panUp(e*(n.object.top-n.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=M()),f/=t},this.dollyOut=function(t){void 0===t&&(t=M()),f*=t},this.update=function(){var t=this.object.position;d.copy(t).sub(this.target),d.applyQuaternion(O);var e=Math.atan2(d.x,d.z),n=Math.atan2(Math.sqrt(d.x*d.x+d.z*d.z),d.y);this.autoRotate&&this.rotateLeft(w()),e+=m,n+=E,n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(1e-6,Math.min(Math.PI-1e-6,n));var o=d.length()*f;o=Math.max(this.minDistance,Math.min(this.maxDistance,o)),this.target.add(b),d.x=o*Math.sin(n)*Math.sin(e),d.y=o*Math.cos(n),d.z=o*Math.sin(n)*Math.cos(e),d.applyQuaternion(R),t.copy(this.target).add(d),this.object.lookAt(this.target),m=0,E=0,f=1,b.set(0,0,0),(v.distanceToSquared(this.object.position)>1e-6||8*(1-y.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(H),v.copy(this.object.position),y.copy(this.object.quaternion))},this.reset=function(){g=T.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",function(t){if(!1!==n.enabled){if(t.preventDefault(),0===t.button){if(!0===n.noRotate)return;g=T.ROTATE,o.set(t.clientX,t.clientY)}else if(1===t.button){if(!0===n.noZoom)return;g=T.DOLLY,u.set(t.clientX,t.clientY)}else if(2===t.button){if(!0===n.noPan)return;g=T.PAN,s.set(t.clientX,t.clientY)}document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",N,!1),n.dispatchEvent(L)}},!1),this.domElement.addEventListener("mousewheel",V,!1),this.domElement.addEventListener("DOMMouseScroll",V,!1),this.domElement.addEventListener("touchstart",function(t){if(!1!==n.enabled){switch(t.touches.length){case 1:if(!0===n.noRotate)return;g=T.TOUCH_ROTATE,o.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===n.noZoom)return;g=T.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,a=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+a*a);u.set(0,i);break;case 3:if(!0===n.noPan)return;g=T.TOUCH_PAN,s.set(t.touches[0].pageX,t.touches[0].pageY);break;default:g=T.NONE}n.dispatchEvent(L)}},!1),this.domElement.addEventListener("touchend",function(){!1!==n.enabled&&(n.dispatchEvent(P),g=T.NONE)},!1),this.domElement.addEventListener("touchmove",function(t){if(!1!==n.enabled){t.preventDefault(),t.stopPropagation();var e=n.domElement===document?n.domElement.body:n.domElement;switch(t.touches.length){case 1:if(!0===n.noRotate)return;if(g!==T.TOUCH_ROTATE)return;a.set(t.touches[0].pageX,t.touches[0].pageY),i.subVectors(a,o),n.rotateLeft(2*Math.PI*i.x/e.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*i.y/e.clientHeight*n.rotateSpeed),o.copy(a),n.update();break;case 2:if(!0===n.noZoom)return;if(g!==T.TOUCH_DOLLY)return;var h=t.touches[0].pageX-t.touches[1].pageX,d=t.touches[0].pageY-t.touches[1].pageY,E=Math.sqrt(h*h+d*d);p.set(0,E),l.subVectors(p,u),l.y>0?n.dollyOut():n.dollyIn(),u.copy(p),n.update();break;case 3:if(!0===n.noPan)return;if(g!==T.TOUCH_PAN)return;c.set(t.touches[0].pageX,t.touches[0].pageY),r.subVectors(c,s),n.pan(r.x,r.y),s.copy(c),n.update();break;default:g=T.NONE}}},!1),window.addEventListener("keydown",function(t){if(!1!==n.enabled&&!0!==n.noKeys&&!0!==n.noPan)switch(t.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed),n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed),n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0),n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0),n.update()}},!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);
